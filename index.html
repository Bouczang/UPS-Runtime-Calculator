<!DOCTYPE html>
<html>
<head>
    <title>UPS Runtime Calculator (Advanced)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        #ups-calculator {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        h2 {
            color: #333;
            text-align: center;
        }
        label {
            display: inline-block;
            width: 250px;
            margin-bottom: 8px;
            font-weight: bold;
        }
        input, select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 120px;
        }
        button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #0055aa;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            background: #e9f7fe;
            border-radius: 4px;
            border-left: 4px solid #0066cc;
        }
        #custom-config {
            margin-top: 10px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div id="ups-calculator">
        <h2>UPS Runtime Calculator (Advanced)</h2>
        <div>
            <label for="battery-capacity">Single Battery Capacity (Ah):</label>
            <input type="number" id="battery-capacity" step="0.1" placeholder="e.g., 100">
        </div>
        <div>
            <label for="battery-voltage">Single Battery Voltage (V):</label>
            <input type="number" id="battery-voltage" value="12">
        </div>
        <div>
            <label for="battery-count">Total Number of Batteries:</label>
            <input type="number" id="battery-count" value="4">
        </div>
        <div>
            <label for="arrangement">Battery Arrangement:</label>
            <select id="arrangement">
                <option value="parallel">Parallel (↑ Capacity, Voltage same)</option>
                <option value="series">Series (↑ Voltage, Capacity same)</option>
                <option value="custom">Custom (Series-Parallel)</option>
            </select>
        </div>
        <div id="custom-config" style="display: none;">
            <label for="series-count">Batteries in Series per String:</label>
            <input type="number" id="series-count" value="2" min="1">
            <label for="parallel-strings">Parallel Strings:</label>
            <input type="number" id="parallel-strings" value="2" min="1">
        </div>
        <div>
            <label for="load-power">Load Power (W):</label>
            <input type="number" id="load-power" placeholder="e.g., 500">
        </div>
        <div>
            <label for="efficiency">Efficiency Factor (0.8-1.0):</label>
            <input type="number" id="efficiency" value="0.9" step="0.01" min="0.8" max="1.0">
        </div>
        <button id="calculate-btn">Calculate Runtime</button>
        <div id="result"></div>
    </div>
 
    <script>
        // Toggle custom config visibility
        document.getElementById('arrangement').addEventListener('change', function() {
            const customConfig = document.getElementById('custom-config');
customConfig.style.display = this.value === 'custom' ? 'block' : 'none';
        });
 
        // Calculate runtime when button is clicked
        document.getElementById('calculate-btn').addEventListener('click', calculateRuntime);
 
        function calculateRuntime() {
            // Get input values
            const capacity = parseFloat(document.getElementById('battery-capacity').value);
            const voltage = parseFloat(document.getElementById('battery-voltage').value);
            const totalBatteries = parseFloat(document.getElementById('battery-count').value);
            const load = parseFloat(document.getElementById('load-power').value);
            const efficiency = parseFloat(document.getElementById('efficiency').value);
            const arrangement = document.getElementById('arrangement').value;
 
            // Validate inputs
            if (isNaN(capacity) || isNaN(voltage) || isNaN(totalBatteries) || isNaN(load) || isNaN(efficiency)) {
                alert("Please fill in all fields with valid numbers!");
                return;
            }
 
            // Calculate total voltage and capacity based on arrangement
            let totalV, totalAh;
            switch (arrangement) {
                case 'parallel':
                    totalV = voltage;
                    totalAh = capacity * totalBatteries;
                    break;
                case 'series':
                    totalV = voltage * totalBatteries;
                    totalAh = capacity;
                    break;
                case 'custom':
                    const seriesCount = parseFloat(document.getElementById('series-count').value);
                    const parallelStrings = parseFloat(document.getElementById('parallel-strings').value);
                    if (isNaN(seriesCount) || isNaN(parallelStrings)) {
                        alert("Please specify valid series/parallel values!");
                        return;
                    }
                    if (seriesCount * parallelStrings !== totalBatteries) {
                        alert(`Custom configuration error: ${seriesCount} series × ${parallelStrings} parallel = ${seriesCount * parallelStrings} batteries, but you specified ${totalBatteries}.`);
                        return;
                    }
                    totalV = voltage * seriesCount;
                    totalAh = capacity * parallelStrings;
                    break;
                default:
                    alert("Invalid battery arrangement!");
                    return;
            }
 
            // Calculate runtime
            const totalWh = totalV * totalAh * efficiency;
            const runtimeHours = totalWh / load;
            const runtimeMinutes = runtimeHours * 60;
 
            // Display result
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <h3>Battery Bank Configuration:</h3>
                <p>Total Voltage: <strong>${totalV}V</strong></p>
                <p>Total Capacity: <strong>${totalAh}Ah</strong></p>
                <p>Total Energy: <strong>${totalWh.toFixed(0)}Wh</strong></p>
                <h3>Estimated Runtime:</h3>
                <p><strong>${runtimeHours.toFixed(2)} hours</strong> (${Math.floor(runtimeHours)}h ${Math.floor((runtimeHours % 1) * 60)}m)</p>
                <p><strong>${Math.round(runtimeMinutes)} minutes</strong></p>
            `;
        }
    </script>
</body>
</html>
